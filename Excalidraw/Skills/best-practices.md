# 设计最佳实践

创建美观专业图表的设计指南。

## 布局原则

### 对齐

- 元素在网格上对齐（通过坐标）
- 相关元素保持一致的水平/垂直间距
- 使用 50px 的倍数：50, 100, 150, 200

### 层次

- 较大元素 = 更重要
- 用颜色表示关系
- 用 `groupIds` 视觉分组相关项目

### 流向

- 左→右：流程/时间
- 上→下：层次结构
- 同一图表内箭头方向一致

---

## 颜色使用

### 60-30-10 法则

- **60%** - 背景/留白
- **30%** - 主强调色（主要框）
- **10%** - 次强调色（高亮、重点）

### 语义色彩

| 颜色 | 含义 | 背景十六进制 | 描边十六进制 |
|------|------|--------------|--------------|
| 蓝 | 信息、输入、用户 | `#a5d8ff` | `#1971c2` |
| 绿 | 成功、输出、数据库 | `#b2f2bb` | `#2f9e44` |
| 黄 | 警告、决策、流程 | `#ffec99` | `#f08c00` |
| 红 | 错误、危险、停止 | `#ffc9c9` | `#e03131` |
| 紫 | 外部、存储、特殊 | `#d0bfff` | `#9c36b5` |
| 灰 | 中性、禁用、备注 | `#e9ecef` | `#868e96` |

### 单色方案

简约专业风格：
- 所有图形：`#e9ecef` 背景，`#1e1e1e` 描边
- 重要项目：`#a5d8ff` 背景
- 大部分元素保持中性

---

## 排版

### 字号指南

| 用途 | 字号 |
|------|------|
| 主标题 | 28-36 |
| 节标题 | 24 |
| 框内标签 | 20 |
| 描述文字 | 16 |
| 注释/标注 | 14 |
| 细小说明 | 12 |

### 字体选择

| fontFamily | 名称 | 风格 | 适用场景 |
|------------|------|------|----------|
| **5** | Excalidraw 默认 | 手写风 | **推荐**，保持 Excalidraw 特色 |
| **1** | Virgil | 手写风 | 休闲、友好 |
| **2** | Helvetica | 无衬线 | 正式技术文档 |
| **3** | Cascadia | 等宽 | 代码、技术规格 |

**推荐**：使用 `fontFamily: 5`（Excalidraw 默认字体），配合 `roughness: 1`，保持 Excalidraw 的手绘特色风格。

### 容器内文本

- 水平和垂直居中
- 文本简洁（每行 2-4 词）
- 用 `\n` 换行

---

## 图形选择

### 何时使用各图形

| 图形 | 适用场景 |
|------|----------|
| **矩形** | 流程、服务、容器、通用框 |
| **圆角矩形** | 按钮、卡片、用户友好元素 |
| **椭圆** | 开始/结束点、数据库、数据存储 |
| **菱形** | 决策、条件、分支逻辑 |

### 图形尺寸

- 最小（含文本）：80×60
- 标准流程框：120×80
- 大容器（含描述）：160×100+

---

## 箭头最佳实践

### 按用途选择箭头类型

| 样式 | 用途 |
|------|------|
| 实线箭头 | 主要流程、主序列 |
| 虚线箭头 | 响应、返回、可选 |
| 点线箭头 | 引用、依赖 |
| 无箭头（线条） | 关联、分组 |

### 箭头路由

- 优先使用水平或垂直箭头
- 尽量避免斜向箭头
- 复杂路由用肘形连接（L 形点）
- 尽量避免箭头交叉

### 绑定箭头

尽可能将箭头绑定到图形：
```json
"startBinding": { "elementId": "shape-id", "focus": 0, "gap": 5 }
```
这样移动图形时箭头会自动更新。

---

## 图表类型技巧

### 流程图

1. 开始用椭圆（Start）
2. 流程用矩形
3. 决策用菱形
4. 决策箭头标注（Yes/No）
5. 结束用椭圆（End）
6. 流向上→下或左→右

### 架构图

1. 分组相关服务
2. 用颜色区分层级（前端、后端、数据）
3. 连接标注协议（HTTP, gRPC, SQL）
4. 多颜色时包含图例
5. 用框架或大矩形显示边界

### 时序图

1. 参与者置于顶部，用矩形
2. 垂直虚线（生命线）
3. 水平箭头表示消息
4. 按顺序编号消息
5. 返回用虚线箭头

### 实体关系图

1. 实体用矩形
2. 包含关键字段作为文本
3. 线条表示关系
4. 标注基数（1:N, M:N）

---

## 粗糙度设置

| 值 | 效果 | 适用场景 |
|-----|------|----------|
| `1` | 轻微手绘感 | **默认推荐**，保持 Excalidraw 特色 |
| `0` | 干净、精确线条 | 正式文档、技术规格 |
| `2` | 明显草图风 | 头脑风暴、非正式 |

**推荐**：使用 `roughness: 1` 保持 Excalidraw 的手绘风格特色。

### 手绘风格关键属性

> **重要**：要实现 Excalidraw 的标志性手绘效果，必须正确设置以下两个属性：

| 属性 | 推荐值 | 说明 |
|------|--------|------|
| `roughness` | `1` | 控制线条的手绘抖动效果，0=平滑，1=手绘，2=草图 |
| `fontFamily` | `5` | Excalidraw 默认手写字体，保持风格一致 |

**常见错误**：使用 `roughness: 0` 和 `fontFamily: 2` 会导致图表看起来像普通矢量图，失去 Excalidraw 的特色。

**appState 设置**：在 JSON 的 `appState` 中也应设置默认值：
```json
"appState": {
  "currentItemRoughness": 1,
  "currentItemFontFamily": 5
}
```

---

## 常见错误

| 错误 | 正确做法 |
|------|----------|
| **颜色过多** | 最多 2-3 种强调色 |
| **间距不一** | 全局使用相同间距 |
| **文字太小** | 最小 14px 保证可读性 |
| **箭头无标签** | 复杂流程添加标签 |
| **布局拥挤** | 留出空白，分散元素 |
| **缺少图例** | 使用颜色/图形编码时添加 |
| **箭头交叉** | 重新路由避免交叉 |
| **图形不一致** | 相同概念用相同图形类型 |

---

## 快速参考：专业模板

### 干净专业风格

> 注意：此风格会失去 Excalidraw 的手绘特色，仅用于需要正式外观的场景。

```json
{
  "strokeColor": "#1e1e1e",
  "backgroundColor": "#e9ecef",
  "fillStyle": "solid",
  "strokeWidth": 2,
  "strokeStyle": "solid",
  "roughness": 0,
  "opacity": 100,
  "fontFamily": 2,
  "fontSize": 16
}
```

### 手绘风格（推荐）

```json
{
  "strokeColor": "#1e1e1e",
  "backgroundColor": "#e9ecef",
  "fillStyle": "solid",
  "strokeWidth": 2,
  "strokeStyle": "solid",
  "roughness": 1,
  "opacity": 100,
  "fontFamily": 5,
  "fontSize": 16
}
```

### 高亮/重要元素

```json
{
  "backgroundColor": "#a5d8ff",
  "strokeColor": "#1971c2"
}
```

---

## 响应式尺寸

不同查看尺寸的图表设计：

- 相对定位（元素按比例间距）
- 最小画布：600×400
- 标准画布：800×600
- 大型/复杂：1200×800+

---

## 测试图表

1. 将 JSON 粘贴到 [excalidraw.com](https://excalidraw.com)
2. 检查视觉问题
3. 验证所有文本可读
4. 确保箭头方向正确
5. 测试放大/缩小

---

## 设计检查清单

创建图表前：
- [ ] 规划好布局结构
- [ ] 选定配色方案（2-3 色）
- [ ] 确定流向
- [ ] 决定粗糙度（正式=0，休闲=1-2）

创建后：
- [ ] 所有元素对齐
- [ ] 间距一致
- [ ] 文本可读（≥14px）
- [ ] 箭头方向正确
- [ ] 颜色语义正确
- [ ] 无交叉箭头
- [ ] 复杂流程有标签
